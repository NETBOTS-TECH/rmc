(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3425],{9876:function(e,t,r){Promise.resolve().then(r.bind(r,72128))},72128:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var s=r(57437),n=r(2265),a=r(68680),l=r(62869),i=r(95186),o=r(66070),c=r(53417),d=r(95805),u=r(44743),m=r(73247);let f=(0,r(79205).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var x=r(73578),h=r(90535),g=r(94508);let p=(0,h.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function v(e){let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{className:(0,g.cn)(p({variant:r}),t),...n})}var b=r(40257);let j=(0,a.io)(b.env.BASE_URL||"http://localhost:5000",{transports:["websocket","polling"],reconnectionAttempts:5,timeout:1e4});function y(){var e;let[t,r]=(0,n.useState)([]),[a,h]=(0,n.useState)(null),[g,p]=(0,n.useState)(""),[y,N]=(0,n.useState)({}),[w,k]=(0,n.useState)([]),[C,T]=(0,n.useState)(1),[R,S]=(0,n.useState)(""),[A,Z]=(0,n.useState)("");(0,n.useEffect)(()=>{if(!j)return;let e="Agent-".concat(Math.floor(1e3*Math.random()));return j.emit("register-agent",e),Z(e),j.on("client-assigned",e=>{let{clientId:t}=e;console.log("Client assigned:",t),h(t),N(e=>({...e,[t]:[...e[t]||[]]})),r(Object.keys({...y,[t]:[...y[t]||[]]}))}),j.on("receive-message",e=>{let{sender:t,message:s,chatId:n}=e;console.log("New message:",{sender:t,message:s,chatId:n}),N(e=>({...e,[n]:[...e[n]||[],{sender:t,message:s,timestamp:new Date}]})),r(Object.keys({...y,[n]:[...y[n]||[],{sender:t,message:s,timestamp:new Date}]}))}),()=>{console.log("Removing socket listeners..."),j.off("update-clients"),j.off("receive-message")}},[]),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(b.env.BASE_URL,"/api/chat-user"));if(!e.ok)throw Error("Failed to fetch chat users");let t=await e.json();k(t)}catch(e){console.error("Error fetching chat users:",e)}})()},[]);let E=()=>{if(g.trim()&&a){let e={sender:"Agent",message:g,timestamp:new Date};N(t=>({...t,[a]:[...t[a]||[],e]})),j.emit("agent-message",{agentId:A,message:g}),p("")}},L=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),z=w.filter(e=>{var t,r,s;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(R.toLowerCase()))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(R.toLowerCase()))||(null===(s=e.phone)||void 0===s?void 0:s.includes(R))}),M=Math.ceil(z.length/5),O=z.slice((C-1)*5,5*C);return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Customer Support Dashboard"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)(o.Zb,{className:"lg:col-span-1",children:[(0,s.jsx)(o.Ol,{className:"bg-gray-50 pb-2",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)(o.ll,{className:"flex items-center",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 mr-2 text-blue-500"}),"Active Conversations"]})})}),(0,s.jsx)(o.aY,{className:"pt-4",children:t.length>0?(0,s.jsx)("div",{className:"space-y-2 max-h-[500px] overflow-y-auto pr-2",children:t.map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-lg cursor-pointer transition-all duration-200 flex items-center \n                      ".concat(a===e?"bg-blue-100 border-l-4 border-blue-500":"hover:bg-gray-100 border-l-4 border-transparent"),onClick:()=>h(e),children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-400 flex items-center justify-center text-white",children:e.substring(0,2).toUpperCase()}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("p",{className:"font-medium",children:e}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:y[e]&&y[e].length>0?y[e][y[e].length-1].message.substring(0,20)+"...":"No messages yet"})]})]},e))}):(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)(d.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),(0,s.jsx)("p",{className:"text-gray-500",children:"No active conversations"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Waiting for customers to connect..."})]})})]}),(0,s.jsxs)(o.Zb,{className:"lg:col-span-2",children:[(0,s.jsx)(o.Ol,{className:"bg-gray-50 pb-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(o.ll,{className:"flex items-center",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-400 flex items-center justify-center text-white mr-2",children:a.substring(0,2).toUpperCase()}),(0,s.jsx)("span",{children:a})]}):(0,s.jsx)("span",{children:"Select a conversation"})}),a&&(0,s.jsx)(v,{variant:"outline",className:"bg-green-50 text-green-600",children:"Online"})]})}),(0,s.jsx)(o.aY,{className:"p-0",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-[400px] overflow-y-auto p-4 space-y-3",children:(null===(e=y[a])||void 0===e?void 0:e.length)>0?y[a].map((e,t)=>(0,s.jsx)("div",{className:"flex ".concat("Agent"===e.sender?"justify-end":"justify-start"),children:(0,s.jsxs)("div",{className:"max-w-[70%] p-3 rounded-lg shadow-sm\n                          ".concat("Agent"===e.sender?"bg-blue-500 text-white rounded-br-none":"bg-gray-100 rounded-bl-none"),children:[(0,s.jsxs)("div",{className:"flex items-center mb-1",children:[(0,s.jsx)("span",{className:"font-medium text-sm",children:"Agent"===e.sender?"You":e.sender}),(0,s.jsx)("span",{className:"text-xs ml-2 opacity-70",children:e.timestamp?L(e.timestamp):""})]}),(0,s.jsx)("p",{className:"text-sm",children:e.message})]})},t)):(0,s.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center text-gray-500",children:[(0,s.jsx)(c.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),(0,s.jsx)("p",{children:"No messages yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Send a message to start the conversation"})]})})}),(0,s.jsx)("div",{className:"p-3 border-t",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(i.I,{value:g,onChange:e=>p(e.target.value),placeholder:"Type your message...",className:"focus-visible:ring-blue-500",onKeyDown:e=>"Enter"===e.key&&E()}),(0,s.jsx)(l.z,{onClick:E,className:"bg-blue-500 hover:bg-blue-600",children:(0,s.jsx)(u.Z,{className:"h-4 w-4"})})]})})]}):(0,s.jsx)("div",{className:"h-[450px] flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center text-gray-500",children:[(0,s.jsx)(c.Z,{className:"h-16 w-16 text-gray-300 mx-auto mb-3"}),(0,s.jsx)("p",{className:"text-lg font-medium",children:"No conversation selected"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Select a customer from the list to start chatting"})]})})})]})]}),(0,s.jsxs)(o.Zb,{className:"mt-6",children:[(0,s.jsx)(o.Ol,{className:"bg-gray-50 pb-2",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,s.jsxs)(o.ll,{className:"flex items-center",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 mr-2 text-blue-500"}),"Customer Database"]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,s.jsx)(i.I,{placeholder:"Search users...",className:"pl-9 max-w-xs",value:R,onChange:e=>S(e.target.value)})]})]})}),(0,s.jsxs)(o.aY,{children:[(0,s.jsx)("div",{className:"rounded-lg border overflow-hidden",children:(0,s.jsxs)(x.iA,{children:[(0,s.jsx)(x.xD,{children:(0,s.jsxs)(x.SC,{className:"bg-gray-50",children:[(0,s.jsx)(x.ss,{className:"w-[50px]",children:"#"}),(0,s.jsx)(x.ss,{children:"Name"}),(0,s.jsx)(x.ss,{children:"Email"}),(0,s.jsx)(x.ss,{children:"Phone"})]})}),(0,s.jsx)(x.RM,{children:O.length>0?O.map((e,t)=>(0,s.jsxs)(x.SC,{className:"hover:bg-gray-50",children:[(0,s.jsx)(x.pj,{className:"font-medium",children:(C-1)*5+t+1}),(0,s.jsx)(x.pj,{children:e.name}),(0,s.jsx)(x.pj,{children:e.email}),(0,s.jsx)(x.pj,{children:e.phone})]},e._id)):(0,s.jsx)(x.SC,{children:(0,s.jsx)(x.pj,{colSpan:5,className:"h-24 text-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center text-gray-500",children:[(0,s.jsx)(f,{className:"h-10 w-10 text-gray-300 mb-2"}),R?"No users match your search":"No users found"]})})})})]})}),M>1&&(0,s.jsxs)("div",{className:"flex justify-center mt-4 gap-1",children:[(0,s.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>T(e=>Math.max(1,e-1)),disabled:1===C,children:"Previous"}),Array.from({length:M},(e,t)=>t+1).map(e=>(0,s.jsx)(l.z,{variant:C===e?"default":"outline",size:"sm",onClick:()=>T(e),children:e},e)),(0,s.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>T(e=>Math.min(M,e+1)),disabled:C===M,children:"Next"})]})]})]})]})}},62869:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var s=r(57437),n=r(2265),a=r(37053),l=r(90535),i=r(94508);let o=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:l,asChild:c=!1,...d}=e,u=c?a.g7:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:n,size:l,className:r})),ref:t,...d})});c.displayName="Button"},66070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return d},eW:function(){return u},ll:function(){return o}});var s=r(57437),n=r(2265),a=r(94508);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...n})});i.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});o.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...n})});d.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},95186:function(e,t,r){"use strict";r.d(t,{I:function(){return l}});var s=r(57437),n=r(2265),a=r(94508);let l=n.forwardRef((e,t)=>{let{className:r,type:n,...l}=e;return(0,s.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...l})});l.displayName="Input"},73578:function(e,t,r){"use strict";r.d(t,{RM:function(){return o},SC:function(){return c},iA:function(){return l},pj:function(){return u},ss:function(){return d},xD:function(){return i}});var s=r(57437),n=r(2265),a=r(94508);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,a.cn)("w-full caption-bottom text-sm",r),...n})})});l.displayName="Table";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("thead",{ref:t,className:(0,a.cn)("[&_tr]:border-b",r),...n})});i.displayName="TableHeader";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,a.cn)("[&_tr:last-child]:border-0",r),...n})});o.displayName="TableBody",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,a.cn)("bg-primary font-medium text-primary-foreground",r),...n})}).displayName="TableFooter";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tr",{ref:t,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...n})});c.displayName="TableRow";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("th",{ref:t,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...n})});d.displayName="TableHead";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("td",{ref:t,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...n})});u.displayName="TableCell",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("caption",{ref:t,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",r),...n})}).displayName="TableCaption"},94508:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(61994),n=r(53335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}},79205:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var s=r(2265);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...l,width:n,height:n,stroke:r,strokeWidth:o?24*Number(i)/Number(n):i,className:a("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,s.forwardRef)((r,l)=>{let{className:o,...c}=r;return(0,s.createElement)(i,{ref:l,iconNode:t,className:a("lucide-".concat(n(e)),o),...c})});return r.displayName="".concat(e),r}},73247:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},95805:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(79205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},40257:function(e,t,r){"use strict";var s,n;e.exports=(null==(s=r.g.process)?void 0:s.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(44227)},44227:function(e){!function(){var t={229:function(e){var t,r,s,n=e.exports={};function a(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:l}catch(e){r=l}}();var o=[],c=!1,d=-1;function u(){c&&s&&(c=!1,s.length?o=s.concat(o):d=-1,o.length&&m())}function m(){if(!c){var e=i(u);c=!0;for(var t=o.length;t;){for(s=o,o=[];++d<t;)s&&s[d].run();d=-1,t=o.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===l||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function x(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.push(new f(e,t)),1!==o.length||c||i(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=x,n.addListener=x,n.once=x,n.off=x,n.removeListener=x,n.removeAllListeners=x,n.emit=x,n.prependListener=x,n.prependOnceListener=x,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function s(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}},l=!0;try{t[e](a,a.exports,s),l=!1}finally{l&&delete r[e]}return a.exports}s.ab="//";var n=s(229);e.exports=n}()}},function(e){e.O(0,[5569,8109,2971,2117,1744],function(){return e(e.s=9876)}),_N_E=e.O()}]);